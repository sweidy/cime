<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>10. Data River (DROF) &mdash; CIME with documentation about the Replay cime5.6.replay documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5d88beb4"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/pop_ver.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="11. Data Wave (DWAV)" href="data-wave.html" />
    <link rel="prev" title="9. Data Ocean (DOCN)" href="data-ocean.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            CIME with documentation about the Replay
          </a>
              <div class="version">
                cime5.6.replay
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../what_cime/index.html">What is CIME?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/index.html">Case Control System Part 1: Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/index.html#case-control-system-part-2-configuration-porting-testing-and-use-cases">Case Control System Part 2: Configuration, Porting, Testing and Use Cases</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Data Models</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="input-namelists.html">2. Input Namelists</a></li>
<li class="toctree-l2"><a class="reference internal" href="input-streams.html">3. Input Streams</a></li>
<li class="toctree-l2"><a class="reference internal" href="design-details.html">4. Design Details</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-model-science.html">5. Data Model Science</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-atm.html">6. Data Atmosphere (DATM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-lnd.html">7. Data Land (DLND)</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-seaice.html">8. Data Ice (DICE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-ocean.html">9. Data Ocean (DOCN)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">10. Data River (DROF)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#xml-variables">10.1. xml variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#datamode-values">10.2. datamode values</a></li>
<li class="toctree-l3"><a class="reference internal" href="#namelists">10.3. Namelists</a></li>
<li class="toctree-l3"><a class="reference internal" href="#drof-mode-datamode-and-streams">10.4. DROF_MODE, datamode and streams</a></li>
<li class="toctree-l3"><a class="reference internal" href="#streams-independent-of-drof-mode-value">10.5. Streams independent of DROF_MODE value</a></li>
<li class="toctree-l3"><a class="reference internal" href="#drof-field-names">10.6. DROF Field names</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="data-wave.html">11. Data Wave (DWAV)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../driver_cpl/index.html">Driver/Coupler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build_cpl/index.html">Building a Coupled Model with CIME</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc_tools/index.html">Miscellaneous Tools</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary/index.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tools_user/index.html">User Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xml_files/index.html">XML Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CIME_api/modules.html">CIME</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tools_api/modules.html">Tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CIME with documentation about the Replay</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Data Models</a></li>
      <li class="breadcrumb-item active"><span class="section-number">10. </span>Data River (DROF)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/data_models/data-river.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="data-river-drof">
<span id="data-river"></span><h1><span class="section-number">10. </span>Data River (DROF)<a class="headerlink" href="#data-river-drof" title="Link to this heading"></a></h1>
<p>The data river model (DROF) provides river runoff data primarily to be used by the prognostic ocean component.
This data can either be observational (climatological or interannual river data) or data from a previous model run that is output to coupler history files and then read back in by DROF.</p>
<section id="xml-variables">
<span id="drof-xml-vars"></span><h2><span class="section-number">10.1. </span>xml variables<a class="headerlink" href="#xml-variables" title="Link to this heading"></a></h2>
<p>The following are xml variables that CIME supports for DROF.
These variables are defined in <code class="docutils literal notranslate"><span class="pre">$CIMEROOT/src/components/data_comps/drof/cime_config/config_component.xml</span></code>.
These variables will appear in <code class="docutils literal notranslate"><span class="pre">env_run.xml</span></code> and are used by the DROF <code class="docutils literal notranslate"><span class="pre">cime_config/buildnml</span></code> script to generate the DROF namelist file <code class="docutils literal notranslate"><span class="pre">drof_in</span></code> and the required associated stream files for the case.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These xml variables are used by the the drof’s <strong>cime_config/buildnml</strong> script in conjunction with drof’s <strong>cime_config/namelist_definition_drof.xml</strong> file to generate the namelist file <code class="docutils literal notranslate"><span class="pre">drof_in</span></code>.</p>
</div>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">“DROF xml variables”</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 15.0%" />
<col style="width: 85.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>xml variable</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>DROF_MODE</p></td>
<td><p>Data mode</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Valid values are: NULL,CPLHIST,DIATREN_ANN_RX1,DIATREN_IAF_RX1,IAF_JRA</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>DROF_CPLHIST_DOMAIN_FILE</p></td>
<td><p>Coupler history forcing data mode - full pathname of model domain file</p></td>
</tr>
<tr class="row-even"><td><p>DROF_CPLHIST_CASE</p></td>
<td><p>Coupler history forcing data mode - case name</p></td>
</tr>
<tr class="row-odd"><td><p>DROF_CPLHIST_DIR</p></td>
<td><p>Coupler history forcing data mode - directory containing coupler history forcing data</p></td>
</tr>
<tr class="row-even"><td><p>DROF_CPLHIST_YR_ALIGN</p></td>
<td><p>Coupler history forcing data mode - simulation year corresponding to DROF_CPLHIST_YR_START</p></td>
</tr>
<tr class="row-odd"><td><p>DROF_CPLHIST_YR_START</p></td>
<td><p>Coupler history forcing data mode - starting year to loop forcing data over</p></td>
</tr>
<tr class="row-even"><td><p>DROF_CPLHIST_YR_END</p></td>
<td><p>Coupler history forcing data mode - ending year to loop forcing data over</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">DROF_MODE</span></code> is set to <code class="docutils literal notranslate"><span class="pre">CPLHIST</span></code>, it is normally assumed that the model domain will be identical to <strong>all</strong> of the stream domains. To ensure this, the xml variables <code class="docutils literal notranslate"><span class="pre">ROF_DOMAIN_PATH</span></code> and <code class="docutils literal notranslate"><span class="pre">ROF_DOMAIN_FILE</span></code> are ignored and a valid setting <strong>must be given</strong> for <code class="docutils literal notranslate"><span class="pre">DROF_CPLHIST_DOMAIN_FILE</span></code>. If <code class="docutils literal notranslate"><span class="pre">DROF_CPLHIST_DOMAIN_FILE</span></code> is set to <code class="docutils literal notranslate"><span class="pre">null</span></code>, then the drof component domain information is read in from the first coupler history file in the target stream and  it is assumed that the first coupler stream file that is pointed to contains the domain  information for that stream. This is the default mode that should be used for this mode. Alternatively, <code class="docutils literal notranslate"><span class="pre">DROF_CPLHIST_DOMAIN_FILE</span></code> can be set to <code class="docutils literal notranslate"><span class="pre">$ROF_DOMAIN_PATH/$ROF_DOMAIN_FILE</span></code> in a non-default configuration.</p>
</div>
</section>
<section id="datamode-values">
<span id="drof-datamodes"></span><h2><span class="section-number">10.2. </span>datamode values<a class="headerlink" href="#datamode-values" title="Link to this heading"></a></h2>
<p>The xml variable <code class="docutils literal notranslate"><span class="pre">DROF_MODE</span></code> (described in <a class="reference internal" href="#drof-mode"><span class="std std-ref">DROF_MODE, datamode and streams</span></a>) sets the streams that are associated with DROF and also sets the namelist variable <code class="docutils literal notranslate"><span class="pre">datamode</span></code>.
<code class="docutils literal notranslate"><span class="pre">datamode</span></code> (which appears in <code class="docutils literal notranslate"><span class="pre">shr_strdata_nml</span></code>) specifies what additional operations need to be done by DROF on the streams before returning to the driver.</p>
<p>Each data model has its own set of supported <code class="docutils literal notranslate"><span class="pre">datamode</span></code> values. The following are the supported DROF <code class="docutils literal notranslate"><span class="pre">datamode</span></code> values, as defined in the file <code class="docutils literal notranslate"><span class="pre">namelist_definition_drof.xml</span></code>.</p>
<table class="docutils align-default" id="id2">
<caption><span class="caption-text">“Valid values for datamode namelist variable”</span><a class="headerlink" href="#id2" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>datamode variable</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>NULL</p></td>
<td><p>Turns off the data model as a provider of data to the coupler.  The rof_present flag will be set to false and the coupler will assume no exchange of data to or from the data model.</p></td>
</tr>
<tr class="row-odd"><td><p>COPYALL</p></td>
<td><p>Copies all fields directly from the input data streams Any required fields not found on an input stream will be set to zero.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="namelists">
<h2><span class="section-number">10.3. </span>Namelists<a class="headerlink" href="#namelists" title="Link to this heading"></a></h2>
<p>The data river runoff model (DROF) provides data river input to prognostic components such as the ocean.</p>
<p>The namelist file for DROF is <code class="docutils literal notranslate"><span class="pre">drof_in</span></code>.</p>
<p>As is the case for all data models, DROF namelists can be separated into two groups, stream-independent and stream-dependent.
The stream dependent group is <a class="reference internal" href="input-streams.html#input-streams"><span class="std std-ref">shr_strdata_nml</span></a>.
The stream-independent group is <code class="docutils literal notranslate"><span class="pre">drof_nml</span></code> and the DROF stream-independent namelist variables are:</p>
<table class="docutils align-default" id="drof-stream-independent-namelists">
<tbody>
<tr class="row-odd"><td><p>decomp</p></td>
<td><p>decomposition strategy (1d, root)</p>
<p>1d =&gt; vector decomposition, root =&gt; run on master task</p>
</td>
</tr>
<tr class="row-even"><td><p>restfilm</p></td>
<td><p>master restart filename</p></td>
</tr>
<tr class="row-odd"><td><p>restfils</p></td>
<td><p>stream restart filename</p></td>
</tr>
<tr class="row-even"><td><p>force_prognostic_true</p></td>
<td><p>TRUE =&gt; force prognostic behavior</p></td>
</tr>
</tbody>
</table>
<p>To change the namelist settings in <code class="docutils literal notranslate"><span class="pre">drof_in</span></code>, edit the file <code class="docutils literal notranslate"><span class="pre">user_nl_drof</span></code> in your case directory.</p>
</section>
<section id="drof-mode-datamode-and-streams">
<span id="drof-mode"></span><h2><span class="section-number">10.4. </span>DROF_MODE, datamode and streams<a class="headerlink" href="#drof-mode-datamode-and-streams" title="Link to this heading"></a></h2>
<p>The following table describes the valid values of <code class="docutils literal notranslate"><span class="pre">DROF_MODE</span></code> (defined in the <code class="docutils literal notranslate"><span class="pre">config_component.xml</span></code> file for DROF), and how they relate to the associated input streams and the <code class="docutils literal notranslate"><span class="pre">datamode</span></code> namelist variable.
CIME will generate a value of <code class="docutils literal notranslate"><span class="pre">DROF_MODE</span></code> based on the compset.</p>
<table class="docutils align-default" id="id3">
<caption><span class="caption-text">“Relationship between DROF_MODE, datamode and streams”</span><a class="headerlink" href="#id3" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 15.0%" />
<col style="width: 85.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>DROF_MODE</p></th>
<th class="head"><p>description-streams-datamode</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>NULL</p></td>
<td><p>null mode</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>streams: none</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>datamode: NULL</p></td>
</tr>
<tr class="row-odd"><td><p>DIATREN_ANN_RX1</p></td>
<td><p>Reads in annual forcing river data used for CORE2 forcing runs.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>streams: rof.diatren_ann_rx1</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>datamode: COPYALL</p></td>
</tr>
<tr class="row-even"><td><p>DIATREN_IAF_RX1</p></td>
<td><p>Reads in intra-annual forcing river data used for CORE2 forcing runs.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>streams: rof.diatren_iaf_rx1</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>datamode: COPYALL</p></td>
</tr>
<tr class="row-odd"><td><p>CPLHIST</p></td>
<td><p>Reads in data from coupler history files generated by a previous run.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>streams: rof.cplhist</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>datamode: COPYALL</p></td>
</tr>
<tr class="row-even"><td><p>IAF_JRA</p></td>
<td><p>Reads in intra-annual forcing river data used for JRA-55 forcing runs.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>streams: rof.iaf_jra</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>datamode: COPYALL</p></td>
</tr>
</tbody>
</table>
</section>
<section id="streams-independent-of-drof-mode-value">
<span id="drof-mode-independent-streams"></span><h2><span class="section-number">10.5. </span>Streams independent of DROF_MODE value<a class="headerlink" href="#streams-independent-of-drof-mode-value" title="Link to this heading"></a></h2>
<p>There are no datamode independent streams for DROF.</p>
</section>
<section id="drof-field-names">
<span id="drof-fields"></span><h2><span class="section-number">10.6. </span>DROF Field names<a class="headerlink" href="#drof-field-names" title="Link to this heading"></a></h2>
<p>DROF defines a set of pre-defined internal field names as well as mappings for how those field names map to the fields sent to the coupler.
In general, the stream input file should translate the stream input variable names into the <code class="docutils literal notranslate"><span class="pre">drof_fld</span></code> names for use within the data rofosphere model.</p>
<table class="docutils align-default" id="id4">
<caption><span class="caption-text">“DROF internal field names”</span><a class="headerlink" href="#id4" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>drof_fld (avifld)</p></th>
<th class="head"><p>driver_fld (avofld)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>roff</p></td>
<td><p>Forr_rofl</p></td>
</tr>
<tr class="row-odd"><td><p>ioff</p></td>
<td><p>Forr_rofi</p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="data-ocean.html" class="btn btn-neutral float-left" title="9. Data Ocean (DOCN)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="data-wave.html" class="btn btn-neutral float-right" title="11. Data Wave (DWAV)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, U.S. National Science Foundation and U.S. Department of Energy.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
     
<script>var version_json_loc = "../../../versions.json";</script>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>